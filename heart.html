<html lang="en" class=" -webkit-"><head>

  <meta charset="UTF-8">
  
<link rel="apple-touch-icon" type="image/png" href="https://cpwebassets.codepen.io/assets/favicon/apple-touch-icon-5ae1a0698dcc2402e9712f7d01ed509a57814f994c660df9f7a952f3060705ee.png">
<meta name="apple-mobile-web-app-title" content="CodePen">



  <title>CodePen - 3D Particle Heart</title>
  
  
  
  
<style>
* {
  margin: 0;
  padding: 0;
  overflow: hidden;
}
html, body {
  width: 100%;
  height: 100%;
}
#info {
  position: absolute;
  COLOR:  #fff;
  top: 0px;
  font-size: 36;
  width: 100%;
  text-align: left;
  z-index: 100;
  display:block;
}
</style>

  <script>
  window.console = window.console || function(t) {};
</script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>

  
  <script>
  if (document.location.search.match(/type=embed/gi)) {
    window.parent.postMessage("resize", "*");
  }
</script>


</head>

<body translate="no" data-new-gr-c-s-check-loaded="14.1086.0" data-gr-ext-installed="">
  
    <script src="https://cpwebassets.codepen.io/assets/common/stopExecutionOnTimeout-2c7831bb44f98c1391d6a4ffda0e1fd302503391ca806e7fcc7b9b87197aec26.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r70/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.16.1/TweenMax.min.js"></script>
      <script id="rendered-js">
var renderer,scene,camera,cubes = [],groups = [];
// var geometry = new THREE.BoxGeometry(30, 30, 30);
var offset = 60;
var animation = new TimelineMax({ repeat: -1, delay: 2 });

var shape = new THREE.Shape();
shape.moveTo(0, 12);
shape.bezierCurveTo(16, 28, 32, 12, 16, -4);
shape.lineTo(0, -20);
shape.lineTo(-16, -4);
shape.bezierCurveTo(-32, 12, -16, 28, 0, 12);


var extrudeSettings = {
    steps: 1, 
    depth: 1,
    bevelThickness: 1, 
    bevelEnabled: true,
    bevelSize: 1,
    bevelSegments: 1,
    curveSegments: 12, 
};
var geometry = new THREE.ExtrudeGeometry(shape, 1);


function initScene() {
  scene = new THREE.Scene();
}

function initCamera() {
  camera = new THREE.PerspectiveCamera(45, innerWidth / innerHeight, 1, 1000);
  camera.position.y = 220;
  camera.position.z = 800;
  camera.lookAt(scene.position);
}

function initLights() {
  var light = new THREE.DirectionalLight(0xffffff, 0.7);
  light.position.set(-100, 200, 200);
  scene.add(light);

  var light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(100, 100, 200);
  scene.add(light);
}

function initRenderer() {
  renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(innerWidth, innerHeight);
  renderer.setClearColor(0x262626);
  document.body.appendChild(renderer.domElement);
}

function createHeart() {
  heart = new THREE.Group();
  scene.add(heart);
  createLevel(0, 1);
  createLevel(1, 3);
  createLevel(2, 5);
  createLevel(3, 7);
  createLevel(4, 9);
  createLevel(5, 9);
  createLevel(6, 7);
  createLevel(7, 5, true);

}

function createLevel(level, lineCount, excludeCenter) {
  var group = new THREE.Group();
  group.level = level;
  var color = 0xE31749;
  heart.add(group);
  groups.push(group);
  group.position.y = -200 + offset * level;
  var x = -offset * parseInt(lineCount / 2);

  for (var i = 0; i < lineCount; ++i) {
    if (excludeCenter && i == parseInt(lineCount / 2)) {
      x += offset;
      continue;
    }
    if (level % 2) {
      color = 0xF22C5D;
    }

    var material = new THREE.MeshPhongMaterial({ color: color });
    var cube0 = new THREE.Mesh(geometry, material);
    var cube1 = new THREE.Mesh(geometry, material);
    cubes.push(cube0, cube1);
    cube0.position.set(x, 0, offset / 2);
    // cube1.position.set(x, 0, -offset / 2);
    group.add(cube0);
    // group.add(cube1);
    x += offset;
  }
}

function fitToHeart() {
  var animation = new TimelineMax();
  for (var i = 0, len = cubes.length; i < len; ++i) {
    var cube = cubes[i];
    var x = cube.position.x;
    var y = cube.position.y;
    var z = cube.position.z;
    cube.position.x = parseInt((-1 + 2 * Math.random()) * innerWidth);
    cube.position.y = parseInt((-1 + 2 * Math.random()) * innerHeight);
    cube.position.z = parseInt((-1 + 2 * Math.random()) * 1);
    animation.to(cube.position, 2, { x: x, y: y, z: z, ease: Expo.easeInOut }, 0);
  }
}

function render() {
  renderer.render(scene, camera);
  requestAnimationFrame(render);
}

function rotateHeart() {
  for (var i = 0, len = groups.length; i < len; ++i) {
    var group = groups[i];
    animation.
    to(group.rotation, 0.4, { y: -0.1 }, 0).
    to(group.rotation, 3, { y: 2 * Math.PI, ease: Expo.easeInOut }, 1.4 - 0.2 * group.level);
  }
}
initScene();
initCamera();
initLights();
initRenderer();
createHeart();
fitToHeart();
rotateHeart();
render();
//# sourceURL=pen.js
    </script>

  <canvas width="2000" height="1236" style="width: 2000px; height: 1236px;"></canvas>

  
<div id="info">Hoang N. Truong</div>
